
- webservice para obtenção de duplas matrícula - data de nascimento
* gestão sessão usuário (autenticação, geração de sessão com timeout, logout)
* gestão permissões menu e adicionamento-remoção

* adicionar teste presenter autenticação
* adicionar restrições chaves únicas (ex user.registration)
* renato autenticação com o moodle





///////// MOODLE webservice auth


package testMoodleLogin;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.ProtocolException;
import java.net.URL;
import java.net.URLEncoder;

//from
// https://docs.moodle.org/dev/Creating_a_web_service_client
// https://github.com/moodlehq/sample-ws-clients/blob/master/JAVA-REST/RestJsonMoodleClient.java
// https://moodle.org/mod/forum/discuss.php?d=215303

/**
 * REST MOODLE Client It's very basic. You'll have to write the JavaObject2POST
 * code.
 *
 * @author Jerome Mouneyrac jerome@moodle.com
 */
public class RestJsonMoodleClient {

    /**
     * Do a REST call to Moodle. Result are displayed in the console log.
     *
     * @param args
     *            the command line arguments
     */
    public static void main(String[] args) throws ProtocolException,
            IOException {

        String serviceURL = "https://moodle.org/login/token.php";

        String urlParameters = "username="
                + URLEncoder.encode("teste_login", "UTF-8") + "&password="
                + URLEncoder.encode("teste_login", "UTF-8") + "&service="
                + URLEncoder.encode("moodle_mobile_app", "UTF-8");

        HttpURLConnection con = (HttpURLConnection) new URL(serviceURL)
                .openConnection();

        con.setRequestMethod("POST");
        // con.setRequestProperty("Content-Type",
        // "application/x-www-form-urlencoded");
        // con.setRequestProperty("Content-Language", "en-US");
        con.setDoOutput(true);
        con.setUseCaches(false);
        con.setDoInput(true);

        DataOutputStream wr = new DataOutputStream(con.getOutputStream());
        wr.writeBytes(urlParameters);
        wr.flush();
        wr.close();

        // Get Response
        InputStream is = con.getInputStream();
        BufferedReader rd = new BufferedReader(new InputStreamReader(is));
        String line;
        StringBuilder response = new StringBuilder();
        while ((line = rd.readLine()) != null) {
            response.append(line);
            response.append('\r');
        }
        rd.close();
        System.out.println(response.toString());

        // success:
        // {"token":"000a000aaaaa00aa00a00aa0a0000000"}
        // error:
        // {"error":"The username was not found in the database","stacktrace":null,"debuginfo":null,"reproductionlink":null}

    }
}
